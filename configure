#!/bin/sh

# Exit this script on error
set -e

if [ ! -f setup.ml ]; then
    # Check for oasis before doing anything
    if ! oasis help &> /dev/null; then
        echo "Can not find oasis, please install it and retry."
        echo "oasis can be found here: http://oasis.forge.ocamlcore.org/"
        exit 1
    fi
    # Generate the setup.ml file
    echo "Generating setup.ml..."
    oasis setup-dev -only-setup
fi

# Configure sources
exec ocaml setup.ml -configure "$@"
